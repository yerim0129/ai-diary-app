# AI 일기 앱 - 고도화 기능 가이드

## 📋 구현된 기능

### 1. ✨ AI 추천 프롬프트

사용자의 최근 일기 패턴을 분석하여 맞춤형 질문을 제공합니다.

**위치**: 일기 작성 페이지 (`/write`)

**작동 방식**:
- 최근 7일간의 일기 감정 패턴 분석
- 연속된 부정적 감정 감지
- 급격한 감정 변화 감지
- 오랜만에 작성하는 경우 감지
- 감정 다양성 분석

**AI 추천 프롬프트 예시**:
- 🔄 오랜만에 작성: "오랜만에 다시 찾아주셨네요! 그동안 어떻게 지내셨나요?"
- 😔 연속 부정적 감정: "최근 계속 힘든 시간을 보내고 계시는군요. 지금 가장 필요한 것은?"
- 📈 감정 급변: "기분이 좋아지셨군요! 무엇이 이 긍정적인 변화를 가져왔나요?"

**사용 방법**:
1. 기분 선택 후 "✨ AI 추천" 박스 확인
2. "이 질문으로 작성하기" 버튼 클릭
3. AI 추천 프롬프트가 메인 프롬프트로 적용됨

---

### 2. 📊 주간/월간 리포트

감정 데이터를 분석하여 주간 또는 월간 리포트를 생성합니다.

**위치**: 리포트 페이지 (`/report`)

**포함 내용**:
- **📊 요약**: 총 작성 수, 가장 많은 감정, 감정 다양성
- **📈 감정 분포**: 각 감정별 빈도 차트
- **📈 감정 추세**: 최근 2주 감정 변화 분석 (개선/하락/안정)
- **✨ AI 인사이트**:
  - 작성 빈도 분석
  - 감정 다양성 피드백
  - 긍정/부정 감정 비율 분석
  - 연속 작성일 축하
- **⭐ 주요 일기**: 각 감정별 대표 일기
- **📥 리포트 다운로드**: 텍스트 파일로 저장

**AI 인사이트 예시**:
- "이번 주 5개의 일기를 작성하셨네요! 꾸준한 기록이 인상적입니다. 💪"
- "행복한 순간이 60%를 차지했어요! 긍정적인 마음가짐이 느껴집니다. ✨"
- "3일 연속으로 일기를 작성하셨네요! 훌륭한 습관입니다. 🔥"

---

### 3. 🤖 감정 분석 (Hugging Face API)

일기 내용을 AI로 분석하여 감정을 자동 감지합니다.

**파일**: `app/composables/useEmotionAnalysis.js`

**2가지 모드**:

#### A) Hugging Face API 모드 (온라인)
- **모델**: `j-hartmann/emotion-english-distilroberta-base`
- **무료 사용**: 가능 (API 키 필요)
- **정확도**: 높음
- **언어**: 영어 (한국어는 번역 필요)

**API 키 발급 방법**:
1. https://huggingface.co 회원가입
2. https://huggingface.co/settings/tokens 에서 "New token" 클릭
3. Role: "Read" 선택
4. `app/composables/useEmotionAnalysis.js` 파일 열기
5. `HUGGING_FACE_API_KEY` 변수에 발급받은 토큰 입력

```javascript
const HUGGING_FACE_API_KEY = 'hf_xxxxxxxxxxxxx' // 여기에 입력
```

#### B) 로컬 분석 모드 (오프라인)
- **방식**: 키워드 기반 감정 분석
- **API 키**: 불필요
- **정확도**: 기본 수준
- **언어**: 한국어 완벽 지원

**작동 원리**:
- 일기 텍스트에서 감정 키워드 탐지
- 각 감정별 키워드 빈도 계산
- 가장 높은 빈도의 감정 반환

**감정 분석 사용 방법**:
```javascript
const { analyzeEmotion, analyzeDiaryEmotion } = useEmotionAnalysis()

// 텍스트 분석
const result = await analyzeEmotion("오늘 정말 행복한 하루였어요!")
// result: { emotion: 'happy', confidence: 85, ... }

// 일기 전체 분석
const analyzedDiary = await analyzeDiaryEmotion(diary)
```

---

## 🚀 사용 방법

### 시작하기
```bash
cd diary-app
npm run dev
```

### 주요 페이지
- **메인 페이지** (`/`): 통계 카드, 최근 일기
- **글쓰기** (`/write`): AI 추천 프롬프트 + 일기 작성
- **캘린더** (`/calendar`): 월별 감정 캘린더
- **대시보드** (`/insights`): 전체 일기 목록 + 감정 통계
- **리포트** (`/report`): 주간/월간 상세 리포트

---

## 📁 파일 구조

```
app/
├── pages/
│   ├── index.vue          # 메인 페이지
│   ├── write.vue          # 일기 작성 (AI 추천 프롬프트)
│   ├── calendar.vue       # 감정 캘린더
│   ├── insights.vue       # 감정 대시보드
│   └── report.vue         # 주간/월간 리포트
├── composables/
│   ├── useDiary.js        # 일기 저장/불러오기
│   ├── useAI.js           # AI 추천 프롬프트 생성
│   └── useEmotionAnalysis.js  # 감정 분석 (Hugging Face)
└── app.vue
```

---

## 🎯 핵심 알고리즘

### AI 추천 프롬프트 로직
```
1. 최근 7일 일기 수집
2. 감정 패턴 분석
   - 감정 빈도 카운트
   - 지배적 감정 추출
   - 감정 다양성 계산
3. 특수 상황 감지
   - 7일 이상 미작성
   - 3일 연속 부정적 감정
   - 이전과 반대 감정
   - 한 가지 감정만 지속
4. 조건별 맞춤 프롬프트 생성
```

### 감정 추세 분석
```
1. 최근 7일 긍정 감정 비율 계산
2. 7-14일 전 긍정 감정 비율 계산
3. 차이 비교
   - +20% 이상: 개선 중 📈
   - -20% 이하: 하락 중 📉
   - 그 외: 안정적 ➡️
```

---

## 🆓 무료 사용 가능한 이유

### Hugging Face Inference API
- **무료 Tier 제공**
- Rate limit: 초당 1회 정도
- Cold start 지연 가능 (첫 요청 시 모델 로딩)
- 개인 프로젝트/학습 용도로 충분

### 대안 (API 키 없이 사용)
- 로컬 키워드 기반 분석 사용
- 정확도는 낮지만 실용적
- 한국어 완벽 지원

---

## 💡 추가 개선 아이디어

### 단기 (즉시 가능)
1. 프롬프트 개수 확장 (현재 8개 → 15개)
2. 감정 세분화 (5개 → 10개)
3. 태그 시스템 추가
4. 검색 기능

### 중기 (1-2주)
1. 이미지 첨부 기능
2. 알림 설정
3. 배지 시스템
4. 데이터 백업 (Firebase/Supabase)

### 장기 (한 달 이상)
1. AI 대화형 일기
2. 감정 코칭
3. 커뮤니티 기능
4. 음성 녹음 일기

---

## 🔧 문제 해결

### Hugging Face API 오류
**증상**: "API 요청 실패" 콘솔 메시지
**해결**:
1. API 키가 올바른지 확인
2. 인터넷 연결 확인
3. Rate limit 초과 여부 확인
4. 로컬 분석 모드로 자동 전환됨 (정상 동작)

### AI 추천 프롬프트가 안 나옴
**증상**: AI 추천 박스가 표시되지 않음
**해결**:
1. 최소 1개 이상의 일기가 있어야 함
2. 브라우저 콘솔에서 오류 확인
3. LocalStorage 데이터 확인

---

## 📌 주의사항

1. **데이터 저장**: 현재 LocalStorage 사용 (브라우저 삭제 시 데이터 손실)
2. **API 키 보안**: API 키를 GitHub에 업로드하지 마세요
3. **Rate Limit**: Hugging Face 무료 tier는 속도 제한 있음
4. **오프라인**: 인터넷 없어도 로컬 분석 모드로 작동

---

## 🎉 완성된 기능 요약

✅ AI 추천 프롬프트 (패턴 기반)
✅ 주간/월간 리포트
✅ 감정 추세 분석
✅ Hugging Face API 통합
✅ 로컬 감정 분석
✅ 리포트 다운로드
✅ 감정 대시보드
✅ 감정 캘린더

**브라우저를 새로고침하고 일기를 작성해보세요!** 🚀
